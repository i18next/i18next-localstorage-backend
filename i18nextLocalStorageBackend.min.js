!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.i18nextLocalStorageBackend=t()}(this,function(){"use strict";function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function t(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e.prefix;return""+(void 0===i?"":i)+n+"-"+t}function e(n,t){try{global.window.localStorage.setItem(n,t)}catch(n){}}function i(n,t){try{return global.window.localStorage.getItem(n,t)}catch(n){return}}var r=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},o=function(){function n(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=function(){function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,a),this.init(t,r({prefix:"i18next_res_",expirationTime:6048e5,versions:{}},e)),this.type="backend"}return o(a,[{key:"init",value:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=t,this.services=n;for(var e in t)void 0===this.options[e]&&(this.options[e]=t[e])}},{key:"get",value:function(n,e){try{return JSON.parse(i(t(n,e,this.options)))}catch(n){return}}},{key:"read",value:function(n,t,e){var i=this,r=this.get(n,t);if(!r)return e(null,null);var o=(new Date).getTime();if(!r.i18nStamp)return e(null,null);if(r.i18nStamp+this.options.expirationTime<o)return e(null,null);var a=this.options.versions[n];return a instanceof Promise?a.then(function(e){data.i18nVersion=e,i.set(n,t,data)}):a!==r.i18nVersion?e(null,null):(delete r.i18nVersion,delete r.i18nStamp,e(null,r))}},{key:"set",value:function(n,i,r){e(t(n,i,this.options),JSON.stringify(r))}},{key:"save",value:function(n,t,e){var i=this;try{e.i18nStamp=(new Date).getTime();var r=this.options.versions[n];if(r instanceof Promise)return r.then(function(r){e.i18nVersion=r,i.set(n,t,e)});if(!r)return this.set(n,t,e);e.i18nVersion=r,this.set(n,t,e)}catch(n){}}}]),a}();return a.type="backend",a});
